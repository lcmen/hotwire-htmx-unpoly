// htmx-ext-head-support@2.0.2 downloaded from https://ga.jspm.io/npm:htmx-ext-head-support@2.0.2/head-support.js

(function(){var e=null;function log(){}function mergeHead(t,r){if(t&&t.indexOf("<head")>-1){const p=document.createElement("html");var a=t.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");var n=a.match(/(<head(\s[^>]*>|>)([\s\S]*?)<\/head>)/im);if(n){var d=[];var o=[];var i=[];var m=[];p.innerHTML=n;var h=p.querySelector("head");var l=document.head;if(h==null)return;var u=new Map;for(const e of h.children)u.set(e.outerHTML,e);var s=e.getAttributeValue(h,"hx-head")||r;for(const t of l.children){var g=u.has(t.outerHTML);var f=t.getAttribute("hx-head")==="re-eval";var v=e.getAttributeValue(t,"hx-preserve")==="true";if(g||v)if(f)o.push(t);else{u.delete(t.outerHTML);i.push(t)}else if(s==="append"){if(f){o.push(t);m.push(t)}}else e.triggerEvent(document.body,"htmx:removingHeadElement",{headElement:t})!==false&&o.push(t)}m.push(...u.values());log("to append: ",m);for(const t of m){log("adding: ",t);var c=document.createRange().createContextualFragment(t.outerHTML);log(c);if(e.triggerEvent(document.body,"htmx:addingHeadElement",{headElement:c})!==false){l.appendChild(c);d.push(c)}}for(const t of o)e.triggerEvent(document.body,"htmx:removingHeadElement",{headElement:t})!==false&&l.removeChild(t);e.triggerEvent(document.body,"htmx:afterHeadMerge",{added:d,kept:i,removed:o})}}}htmx.defineExtension("head-support",{init:function(t){e=t;htmx.on("htmx:afterSwap",(function(t){let r=t.detail.xhr;if(r){var a=r.response;e.triggerEvent(document.body,"htmx:beforeHeadMerge",t.detail)&&mergeHead(a,t.detail.boosted?"merge":"append")}}));htmx.on("htmx:historyRestore",(function(t){e.triggerEvent(document.body,"htmx:beforeHeadMerge",t.detail)&&(t.detail.cacheMiss?mergeHead(t.detail.serverResponse,"merge"):mergeHead(t.detail.item.head,"merge"))}));htmx.on("htmx:historyItemCreated",(function(e){var t=e.detail.item;t.head=document.head.outerHTML}))}})})();var e={};export{e as default};

